(this["webpackJsonpoc-transparency-page-example"]=this["webpackJsonpoc-transparency-page-example"]||[]).push([[0],{149:function(e,a,t){e.exports=t(259)},150:function(e,a,t){},257:function(e,a,t){},259:function(e,a,t){"use strict";t.r(a);t(150);var n=t(0),r=t.n(n),l=t(16),c=t.n(l),o=t(45),s=t(317),i=t(314),u=t(80),m=t.n(u),d=t(301),g=t(38),p=t(315),f=t(99),h=t(100),E=t(8),b=t.n(E),v=t(308),x=t(312),C=t(311),y=t(306),w=t(309),k=t(310),P=t(313),A=t(316),S=t(307),M=t(304),O=t(102),R=t.n(O),Y=t(104),j=t.n(Y),I=t(103),D=t.n(I),B=t(101),$=t.n(B);var q="_2KezC",T="_1XkLR",F=function(e,a){var t,n,r,l=a/e,c=~~(6*l),o=6*l-c,s=1-o;switch(c%6){case 0:t=1,n=o,r=0;break;case 1:t=s,n=1,r=0;break;case 2:t=0,n=1,r=o;break;case 3:t=0,n=s,r=1;break;case 4:t=o,n=0,r=1;break;case 5:t=1,n=0,r=s}return"#"+("00"+(~~(255*t)).toString(16)).slice(-2)+("00"+(~~(255*n)).toString(16)).slice(-2)+("00"+(~~(255*r)).toString(16)).slice(-2)},N=function(e){var a=e.expenses,t=[],n=[];(a=Object(f.orderBy)(a,(function(e){return e.createdAt}))).map((function(e){var a=new m.a(e.createdAt).format("MM/YYYY"),r=t.findIndex((function(e){return e===a}));-1===r&&(r=t.push(a),r--),console.log("Month",r);var l=n.findIndex((function(a){return a.label===e.tags[0]}));-1===l&&"undefined"!==typeof e.tags[0]&&(l=n.push({label:e.tags[0],data:[],backgroundColor:null,borderColor:null,borderWidth:1,stack:"default"}),l-=1),"undefined"!==typeof n[l]&&("undefined"===typeof n[l].data[r]&&(n[l].data[r]=0),n[l].data[r]+=e.amount/100)})),n.map((function(e,a){n[a].backgroundColor=F(n.length,a),n[a].borderColor=F(n.length,a)}));var l={labels:t,datasets:n};return r.a.createElement(h.Bar,{data:l,options:{maintainAspectRatio:!0}})},L=Object(d.a)((function(e){return{root:{flexShrink:0,marginLeft:e.spacing(2.5)}}}));function _(e){var a=L(),t=Object(g.a)(),n=e.count,l=e.page,c=e.rowsPerPage,o=e.onChangePage;return r.a.createElement("div",{className:a.root},r.a.createElement(M.a,{onClick:function(e){o(e,0)},disabled:0===l,"aria-label":"first page"},"rtl"===t.direction?r.a.createElement($.a,null):r.a.createElement(R.a,null)),r.a.createElement(M.a,{onClick:function(e){o(e,l-1)},disabled:0===l,"aria-label":"previous page"},"rtl"===t.direction?r.a.createElement(D.a,null):r.a.createElement(j.a,null)),r.a.createElement(M.a,{onClick:function(e){o(e,l+1)},disabled:l>=Math.ceil(n/c)-1,"aria-label":"next page"},"rtl"===t.direction?r.a.createElement(j.a,null):r.a.createElement(D.a,null)),r.a.createElement(M.a,{onClick:function(e){o(e,Math.max(0,Math.ceil(n/c)-1))},disabled:l>=Math.ceil(n/c)-1,"aria-label":"last page"},"rtl"===t.direction?r.a.createElement(R.a,null):r.a.createElement($.a,null)))}_.propTypes={count:b.a.number.isRequired,onChangePage:b.a.func.isRequired,page:b.a.number.isRequired,rowsPerPage:b.a.number.isRequired};var J=function(e){var a=e.expenses,t=r.a.useState(0),n=t[0],l=t[1],c=r.a.useState(5),o=c[0],s=c[1],i=o-Math.min(o,a.length-n*o);return r.a.createElement(y.a,{component:S.a},r.a.createElement(v.a,{"aria-label":"simple table"},r.a.createElement(w.a,null,r.a.createElement(k.a,null,r.a.createElement(C.a,{align:"left"},"Description"),r.a.createElement(C.a,{align:"left"},"Amount"),r.a.createElement(C.a,{align:"right"},"Status"),r.a.createElement(C.a,{align:"right"},"Tags"))),r.a.createElement(x.a,null,(o>0?a.slice(n*o,n*o+o):a).map((function(e){return r.a.createElement(k.a,{key:e.id},r.a.createElement(C.a,{component:"th",scope:"row"},e.description),r.a.createElement(C.a,{style:{width:160},align:"right"},e.amount/100," ",e.currency),r.a.createElement(C.a,{style:{width:160},align:"right"},e.status),r.a.createElement(C.a,{style:{width:160},align:"right"},e.tags))})),i>0&&r.a.createElement(k.a,{style:{height:53*i}},r.a.createElement(C.a,{colSpan:6}))),r.a.createElement(P.a,null,r.a.createElement(k.a,null,r.a.createElement(A.a,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:3,count:a.length,rowsPerPage:o,page:n,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onChangePage:function(e,a){l(a)},onChangeRowsPerPage:function(e){s(parseInt(e.target.value,10)),l(0)},ActionsComponent:_})))))},K=function(e){var a=e.expenses,t=[],n=[{data:[],backgroundColor:[],hoverBackgroundColor:[]}];(a=Object(f.orderBy)(a,(function(e){return e.createdAt}))).map((function(e){var a,r=null!=(a=e.tags[0])?a:"undefined",l=t.findIndex((function(e){return e===r}));-1===l?(l=t.push(r),n[0].data[l-1]=e.amount/100):n[0].data[l]+=e.amount/100})),t.map((function(e,a){n[0].backgroundColor[a]=F(t.length,a),n[0].hoverBackgroundColor[a]=F(t.length,a)}));var l={labels:t,datasets:n};return r.a.createElement(h.Doughnut,{data:l,options:{maintainAspectRatio:!0}})};function Q(){var e,a,t=(e=["\n  query ExpensesPage(\n    $account: AccountReferenceInput!\n    $slug: String!\n    $offset: Int!\n    $dateFrom: ISODateTime!\n  ) {\n    expenses(\n      account: $account\n      orderBy: { field: CREATED_AT, direction: ASC }\n      offset: $offset\n      limit: 100\n      status: PAID\n      dateFrom: $dateFrom\n    ) {\n      offset\n      totalCount\n      limit\n      nodes {\n        id\n        amount\n        tags\n        description\n        currency\n        status\n        createdAt\n      }\n    }\n    account(slug: $slug) {\n      id\n      imageUrl\n      name\n    }\n  }\n"],a||(a=e.slice(0)),e.raw=a,e);return Q=function(){return t},t}var U=Object(d.a)((function(e){return{root:{flexGrow:1},paper:{height:140,width:100},control:{padding:e.spacing(2)}}})),z=Object(o.gql)(Q()),G={TransparencyPage:function(e){var a=e.slug,t=e.locale,l=e.messages,c=e.date,u=U(),d=Object(n.useState)(800)[0],g=Object(n.useState)(300)[0],f=Object(n.useState)(null!=c?c:"2001-01-01"),h=Object(o.useQuery)(z,{variables:{account:{slug:a},slug:a,offset:0,dateFrom:f}}),E=h.loading,b=h.error,v=h.data,x=h.fetchMore;if(E)return r.a.createElement("p",null,"Loading...");if(b)return r.a.createElement("p",null,"Error :(");var C=v.account,y=v.expenses.nodes;return x({variables:{offset:v.expenses.nodes.length},updateQuery:function(e,a){var t=a.fetchMoreResult;return t?(t.expenses.nodes=e.expenses.nodes.concat(t.expenses.nodes),Object.assign({},t)):e}}).then((function(e){console.log("Res",e)})),l||(l={}),t||(t="en"),r.a.createElement(s.a,{locale:t,defaultLocale:"en",messages:l},r.a.createElement("div",{className:q},r.a.createElement("h1",{className:"header"},r.a.createElement("img",{className:T,src:C.imageUrl,alt:""}),C.name),r.a.createElement("div",{className:"content"},r.a.createElement("h2",null,r.a.createElement(i.a,{id:"allExpensesFrom",defaultMessage:"All expenses from {date}",values:{date:m()(f,"YYYY-MM-DD").format("DD/MM/YYYY")}})),r.a.createElement(p.a,{container:!0,className:u.root,spacing:2},r.a.createElement(p.a,{item:!0,xs:8},r.a.createElement(N,{expenses:y,width:d,height:g})),r.a.createElement(p.a,{item:!0,xs:4},r.a.createElement(K,{expenses:y,width:d,height:g}))),r.a.createElement(J,{expenses:y,width:d,height:g}))))},BarChart:N,PieChart:K,ExpensesTable:J},W=(t(257),localStorage.getItem("apiKey")),X=new o.ApolloClient({uri:"https://api.opencollective.com/graphql/v2/"+W,cache:new o.InMemoryCache}),H=function(){return r.a.createElement(o.ApolloProvider,{client:X},r.a.createElement(G,{client:X,slug:"xr-belgium",date:"2018-01-01",messages:{allExpensesFrom:"All expenses from {date}"}}))};c.a.render(r.a.createElement(H,null),document.getElementById("root"))}},[[149,1,2]]]);
//# sourceMappingURL=main.bf52ac1a.chunk.js.map